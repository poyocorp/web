<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Stuff</title>
  <style>
    @font-face { font-family: 'KirbyFont'; src: url('fonts/kirb.ttf') format('truetype'); }
    :root{ --bg:#ffe96b; --card:#ff8b5a; --accent:#00c37a; --muted:#222 }
    body{ margin:0; font-family: 'Helvetica Neue', Arial, sans-serif; background:var(--bg); color:var(--muted) }
    header{ padding:24px 20px 10px; text-align:center }
    h1{ font-family:KirbyFont, sans-serif; font-size:64px; margin:0 }
    .container{ max-width:1200px; margin:20px auto; padding:0 20px }
    .grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:20px }
    .card{ background:var(--card); border-radius:16px; padding:20px; box-shadow:0 6px 18px rgba(0,0,0,0.08); display:flex; flex-direction:column; justify-content:space-between }
    .card h3{ margin:0 0 10px; font-size:36px; text-align:center }
    .desc{ text-align:center; margin-bottom:16px; line-height:1.4 }
    .meta{ display:flex; justify-content:space-between; align-items:center }
    .username{ font-weight:700 }
    .visit{ background:var(--accent); color:#003; padding:12px 18px; border-radius:12px; text-decoration:none; font-weight:700; box-shadow:0 4px 8px rgba(0,0,0,0.08) }
    .visit:focus,.visit:hover{ transform:translateY(-2px) }
    .toolbar{ display:flex; gap:12px; justify-content:flex-end; margin-bottom:12px }
    .back{ position:fixed; top:12px; left:12px; z-index:1000; background:transparent; border:1px solid rgba(0,0,0,0.06); padding:8px 12px; border-radius:10px; text-decoration:none }
    .empty{ text-align:center; padding:40px; font-size:18px; color:rgba(0,0,0,0.6) }
    @media (max-width:420px){ h1{ font-size:40px } .card h3{ font-size:28px } }
  </style>
</head>
<body>
  <header>
    <h1>Stuff</h1>
  </header>

    <div class="container">
    <a class="back" href="/">← Home</a>

    <div id="grid" class="grid" aria-live="polite"></div>
    <div id="empty" class="empty" style="display:none">No items yet — check back later or use the Admin to add items.</div>
  </div>

  <script>
    async function load(){
      try{
        const res = await fetch('data/stuff.json', {cache: 'no-store'});
        if(!res.ok) throw new Error('Failed to load');
        const items = await res.json();
        const grid = document.getElementById('grid');
        grid.innerHTML = '';
        if(!items || items.length === 0){ document.getElementById('empty').style.display='block'; return }
        items.forEach(it => {
          const card = document.createElement('article');
          card.className = 'card';
          card.innerHTML = `
            <div>
              <h3>${escapeHtml(it.title)}</h3>
              <p class="desc">${escapeHtml(it.description)}</p>
            </div>
            <div class="meta">
              <div class="username">${escapeHtml(it.username)}</div>
              <a class="visit" href="${escapeAttr(it.url)}" target="_blank" rel="noopener noreferrer">Visit ↗</a>
            </div>`;
          grid.appendChild(card);
        });
      }catch(err){ document.getElementById('empty').textContent = 'Unable to load items.' }
    }
    function escapeHtml(s){ if(!s) return ''; return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;') }
    function escapeAttr(s){ return String(s).replace(/"/g,'%22').replace(/'/g,'%27') }
    load();
  </script>
</body>
</html>
